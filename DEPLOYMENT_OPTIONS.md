# 部署方案选择指南

## 概述

本项目提供了多种部署方案，可以根据你的需求选择最适合的方式：

## 方案对比

| 方案 | 优点 | 缺点 | 适用场景 |
|------|------|------|----------|
| **在线部署** | 简单快速，自动更新依赖 | 需要网络连接 | 有网络环境，快速部署 |
| **离线部署** | 无需网络，依赖预下载 | 包体积大，需要预准备 | 无网络环境，批量部署 |
| **静态链接** | 单文件部署，无依赖 | 文件较大，编译复杂 | 简单部署，无依赖要求 |
| **Docker** | 环境隔离，易于管理 | 需要 Docker 环境 | 容器化部署，微服务架构 |

## 详细方案

### 1. 在线部署（推荐用于开发测试）

**适用场景**: 有网络连接，快速部署测试

```bash
# Linux 5.15 系统快速部署
chmod +x deploy_linux.sh
./deploy_linux.sh

# 或完整部署
chmod +x deploy_qt.sh
./deploy_qt.sh
```

**特点**:
- ✅ 自动下载依赖
- ✅ 支持多发行版
- ✅ 完整的错误处理
- ❌ 需要网络连接

### 2. 离线部署（推荐用于生产环境）

**适用场景**: 无网络环境，批量部署，生产环境

#### 步骤 1: 在有网络的机器上准备离线包
```bash
# 下载依赖
chmod +x download_deps.sh
./download_deps.sh

# 创建完整离线包
chmod +x create_offline_package.sh
./create_offline_package.sh
```

#### 步骤 2: 在目标机器上安装
```bash
# 解压离线包
tar -xzf scan-demo-offline-*.tar.gz
cd scan-demo-offline-*

# 安装
chmod +x install.sh
./install.sh

# 启动
./start_offline.sh
```

**特点**:
- ✅ 无需网络连接
- ✅ 依赖预下载
- ✅ 适合批量部署
- ❌ 包体积较大
- ❌ 需要预准备

### 3. 静态链接（推荐用于简单部署）

**适用场景**: 单文件部署，无依赖要求

```bash
# 构建静态链接版本
chmod +x build_static.sh
./build_static.sh

# 部署（复制单个文件即可）
scp scan_demo_static user@target:/path/to/deploy/
```

**特点**:
- ✅ 单文件部署
- ✅ 无依赖要求
- ✅ 适合简单环境
- ❌ 文件较大
- ❌ 只支持 Rust 后端

### 4. Docker 容器化（推荐用于微服务架构）

**适用场景**: 容器化部署，微服务架构，云环境

```bash
# 构建和部署
chmod +x docker_build.sh
./docker_build.sh

# 或使用 docker-compose
docker-compose up -d
```

**特点**:
- ✅ 环境隔离
- ✅ 易于管理
- ✅ 支持云部署
- ✅ 可扩展性好
- ❌ 需要 Docker 环境
- ❌ 资源占用较大

## 选择建议

### 开发测试环境
- **推荐**: 在线部署 (`deploy_linux.sh`)
- **原因**: 简单快速，自动处理依赖

### 生产环境
- **有网络**: 在线部署 + 系统服务 (`install_service.sh`)
- **无网络**: 离线部署 (`create_offline_package.sh`)
- **容器化**: Docker 部署 (`docker_build.sh`)

### 简单部署
- **推荐**: 静态链接 (`build_static.sh`)
- **原因**: 单文件，无依赖

### 批量部署
- **推荐**: 离线部署包
- **原因**: 统一版本，无网络依赖

## 性能对比

| 方案 | 部署时间 | 包大小 | 启动时间 | 资源占用 |
|------|----------|--------|----------|----------|
| 在线部署 | 5-10分钟 | 小 | 快 | 低 |
| 离线部署 | 2-5分钟 | 大 | 快 | 低 |
| 静态链接 | 1分钟 | 中 | 快 | 低 |
| Docker | 3-8分钟 | 大 | 中 | 高 |

## 故障排除

### 在线部署失败
1. 检查网络连接
2. 检查系统权限
3. 查看错误日志
4. 尝试手动安装依赖

### 离线部署失败
1. 检查依赖包完整性
2. 检查系统兼容性
3. 检查磁盘空间
4. 查看安装日志

### 静态链接失败
1. 检查 musl 工具链
2. 检查 Rust 版本
3. 检查目标架构
4. 查看编译日志

### Docker 部署失败
1. 检查 Docker 版本
2. 检查系统资源
3. 检查网络配置
4. 查看容器日志

## 最佳实践

1. **开发阶段**: 使用在线部署快速迭代
2. **测试阶段**: 使用离线部署验证环境
3. **生产阶段**: 使用系统服务或 Docker
4. **维护阶段**: 使用版本化的离线包

## 技术支持

如遇到问题，请：
1. 查看相关日志文件
2. 检查系统环境
3. 参考故障排除指南
4. 联系技术支持
